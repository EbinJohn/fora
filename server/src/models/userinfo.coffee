Models = require './'
AppError = require('../common/apperror').AppError
BaseModel = require('./basemodel').BaseModel

class UserInfo extends BaseModel

    @_getMeta: ->
        User = require('./user').User
        Forum = require('./forum').Forum
        {
            type: UserInfo,
            collection: 'userinfo',
            fields: {
                network: 'string',
                userid: 'string',
                subscriptions: { type: 'array', contents: Forum.Summary, validate: -> item.validate() for item in @subscriptions },
                following: { type: 'array', contents: User.Summary, validate: -> item.validate() for item in @following },
                lastMessageAccessTime: { type: 'number', required: false },
                createdAt: { autoGenerated: true, event: 'created' },
                updatedAt: { autoGenerated: true, event: 'updated' }
            },   
            logging: {
                isLogged: false,
                onInsert: 'NEW_USERINFO'
            }
        }
    
    
    constructor: (params) ->
        @subscriptions ?= []
        @following ?= []
        super
        


    save: (context, cb) =>
        super

    
    
exports.UserInfo = UserInfo
