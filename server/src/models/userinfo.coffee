Models = require './'
AppError = require('../common/apperror').AppError
BaseModel = require('./basemodel').BaseModel
User = require('./user').User
Forum = require('./forum').Forum

class UserInfo extends BaseModel

    ###
        Fields
            - network (string)        
            - userid (string)         
            - subscriptions (list of forum summary)   
            - following (list of user summary)
            - lastMessageAccessTime (integer)
    ###    
        
    @_meta: {
        type: UserInfo,
        collection: 'userinfo',
        fields: {
            network: 'string',
            userid: 'string',
            subscriptions: { type: 'array', contents: Forum.Summary, validate: -> item.validate() for item in @subscriptions },
            following: { type: 'array', contents: User.Summary, validate: -> item.validate() for item in @following },
            lastMessageAccessTime: 'number',
            createdAt: { autoGenerated: true, event: 'created' },
            updatedAt: { autoGenerated: true, event: 'updated' }
        },   
        logging: {
            isLogged: false,
            onInsert: 'NEW_USERINFO'
        }
    }
    
    
    constructor: (params) ->
        @subscriptions ?= []
        @following ?= []
        super
        


    save: (context, cb) =>
        super

    
    
exports.UserInfo = UserInfo
